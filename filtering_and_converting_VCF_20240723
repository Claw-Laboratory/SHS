#Filtering vcf file by sample IDs	
# Define input and output directories
input_dir="/data/SHSusers/MEGA/MEGA/MEGAimpute/for_epacts"
output_dir="vcf/"
sample_file="SHSph2_sample_ID_list_20240722CAS_no_space.txt"

# Loop over chromosomes
for i in {1..22}; do
  echo "Processing chromosome ${i}..."

  # Input and output file paths
  input_file="${input_dir}/chr${i}/chr${i}.filtered.epacts.vcf.gz"
  output_file="${output_dir}/chr${i}_ph2_filtered.vcf"

  # Check if input file exists
  if [ ! -f "${input_file}" ]; then
    echo "Input file ${input_file} does not exist. Skipping chromosome ${i}."
    continue
  fi

  # Ensure output directory exists
  mkdir -p "${output_dir}"

  # Filter the VCF file
  bcftools view -S "${sample_file}" -Oz -o "${output_file}" "${input_file}" --force-samples

  echo "Completed chromosome ${i}."
done

#converting vcf to plink format
#plink --vcf chr19_ph2_filtered.vcf --make-bed --out chr19_ph2
for i in {1..22}; do
  plink --vcf chr${i}_ph2_filtered.vcf.gz --make-bed --out chr${i}_ph2
done
